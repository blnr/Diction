

    <% # Loop through word elements %>
    <% @word.each do |element|  %>

        <% # Audio element attached to word for event listener %>
        <% audio = element["primaries"][0]["terms"][2]["text"] %>
 
        <abbr title="Pronounce">
          <p class="word" onclick="playSound(this, '<%= audio %>');"> 
          <%= element["primaries"][0]["terms"][0]["text"] %> </p>
        </abbr>
        <p class="speech"> <%= element["primaries"][0]["terms"][0]["labels"][0]["text"] %> </p>        

        <ol>
          <% # Set nil definition for first evaluation %>
          <% previous = nil %> 
          
          <% # Loop through definitions (first two) %>
          <% element["primaries"][0]["entries"].first(3).each do |word| %>
            
            <%  # Set definition and example variables %>
            <%  definition = word["terms"][0]["text"] %>
            <%  example    = word["entries"][0]["terms"][0]["text"] rescue false %>

              <% # Ensure definition exists and is not the same as first %>
              <% if (definition rescue false) != false && definition != previous %>
                 <li role="definition"> <%= definition %> </li>
              <% end %>

                  <% # Display Example %>
                  <% if (example rescue false) != false %>
                    <% example.gsub!('x3cemx3e', '').gsub!('x3c/emx3e', '') %>
                    <p class="example">"<%= example %>"</p>
                  <% end %>

            <% # Variable to hold first definition (for next evaluation) %>
            <% previous = element["primaries"][0]["entries"][0]["terms"][0]["text"] %>

          <% end%>  
        </ol> 

    <% end %>
    <% # End word loop %> 


<script>

    // audio for words searched
    function playSound(el,soundfile) {
        var embed = document.getElementById("embed");
        if (!embed) {
            var embed = document.createElement("embed");
                embed.id= "embed";
                embed.setAttribute("src", soundfile);
                embed.setAttribute("hidden", "true");
            el.appendChild(embed);
        } else {
            embed.parentNode.removeChild(embed);
        }
    }

</script>